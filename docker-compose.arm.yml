# Docker Compose configuration for ARM devices (Apple Silicon, ARM servers, etc.)
# Usage: docker-compose -f docker-compose.arm.yml up --build

services:
  smart-intelligence-api:
    build: .
    # Use ARM64 platform for Apple Silicon and ARM servers
    platform: linux/arm64
    container_name: smart-intelligence-api
    ports:
      - "8001:8001"
    environment:
      - PYTHONPATH=/app
      - PYTHONUNBUFFERED=1
      # API Keys
      - GEMINI_API_KEY=AIzaSyDYrBDDTEXVzbb2xAlr2NxZDY4Fqoh4ORw
      - ELEVENLABS_API_KEY=sk_9d1375e7e03e0c325429bf29ac55ee9e8b7d1c932a13cd77
      # Snowflake credentials
      - SNOWFLAKE_ACCOUNT=HQVIWDY-CG89891
      - SNOWFLAKE_USER=DIEGOGM
      - SNOWFLAKE_PASSWORD=Diegogallo12001
      - SNOWFLAKE_WAREHOUSE=SNOWFLAKE_LEARNING_WH
      - SNOWFLAKE_DATABASE=SNOWFLAKE_LEARNING_DB
      - SNOWFLAKE_SCHEMA=PUBLIC
    volumes:
      # Mount .env file if it exists (commented to avoid Docker mounting issues)
      # - ./.env:/app/backend/.env:ro
      # Optional: Mount data directories for persistence
      - ./backend/aidata:/app/backend/aidata:ro
      - ./frontend/media_files:/app/frontend/media_files:ro
    restart: unless-stopped
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8001/api/health"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s

networks:
  default:
    name: smart-intelligence-network

